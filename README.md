# 智能对话代理系统 v5.0

**中文** | [English](README_EN.md)

基于LangChain和Python开发的智能对话代理系统，支持角色扮演、三层记忆管理（短期+长期+知识库）、基础知识库、情感关系分析和Debug日志追踪。

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)

## 📚 文档导航

- **[快速开始](#安装步骤)** - 5分钟快速上手
- **[贡献指南](CONTRIBUTING.md)** - 如何参与项目开发
- **[更新日志](CHANGELOG.md)** - 版本历史和变更记录
- **[API文档](docs/API.md)** - 完整的API参考手册
- **[部署指南](docs/DEPLOYMENT.md)** - 本地、生产、云端部署
- **[开发指南](docs/DEVELOPMENT.md)** - 开发者深入指南
- **[使用示例](docs/EXAMPLES.md)** - 丰富的代码示例
- **[故障排查](docs/TROUBLESHOOTING.md)** - 常见问题解决方案

## 功能特性

### 🎭 角色扮演
- 从.env文件读取角色设定
- 支持自定义角色性格、背景、爱好等
- 默认角色：学生小可（活泼开朗，喜欢历史）

### 🧠 三层记忆系统
- **短期记忆**：保存最近20轮对话的详细内容（memory_data）
- **长期记忆**：超过20轮的对话自动归档为概括性记忆（longmemory_data）
- **知识库**：每5轮对话自动提取知识点（knowledge_base）
- **智能概括**：使用LLM自动生成主题概括和知识提取
- **UUID标识**：每个长期记忆和知识都有唯一标识

### 📚 知识库系统（v3.0）
- **自动提取**：每5轮对话自动分析并提取用户信息
- **结构化存储**：每条知识包含标题、内容、类型、来源、标签等
- **知识分类**：自动分类为个人信息、偏好、事实、经历、观点等
- **搜索功能**：支持关键词搜索和类型筛选
- **UUID追踪**：每条知识都有唯一UUID便于管理
- **时间追溯**：记录知识来源的时间范围

### 🔒 基础知识库系统（v4.0）
- **最高优先级**：优先级100%，绝对准确的核心知识
- **不可更改**：一旦添加，不会被覆盖或修改
- **强制遵循**：即使与AI常识相悖，也必须遵循基础知识
- **不区分大小写**：支持各种大小写形式的查询匹配
- **独立存储**：单独的base_knowledge文件管理
- **GUI管理**：可通过界面查看和添加基础知识
- **默认知识**：预置"HeDaas是一个高校"

### 🔧 Debug调试系统（v4.0）
- **完整日志追踪**：记录模块运行、提示词、API请求/响应
- **实时监控**：GUI中实时显示日志流
- **类型筛选**：支持按类型（module/prompt/request/response/error/info）筛选
- **彩色高亮**：不同类型日志使用不同颜色显示
- **性能分析**：记录API响应时间和处理耗时
- **问题排查**：快速定位问题，查看完整的执行流程
- **可选开关**：通过DEBUG_MODE配置开启/关闭
- **情感分析日志**：记录自动触发、分析过程、语气调整等详细信息

### 💖 情感关系分析系统（v5.0）
- **自动分析**：每10轮对话自动进行情感关系分析
- **多维度评估**：从5个维度评估情感关系（亲密度、信任度、愉悦度、共鸣度、依赖度）
- **关系类型**：自动识别关系类型（初识、朋友、知己等）
- **情感基调**：分析整体情感基调（积极、中性、消极）
- **雷达图可视化**：直观展示5个情感维度的评分
- **语气自适应**：AI根据情感状态自动调整对话语气和态度
- **持久化存储**：情感数据保存到emotion_data，支持历史追踪
- **标签页切换**：时间线和雷达图共享可视化区域，通过标签切换
- **手动分析**：支持随时手动触发情感分析
- **系统提示**：分析完成后在聊天窗口显示结果摘要

### 📊 可视化界面
- **主题时间线**：图形化展示聊天主题的变化轨迹
- **情感关系雷达图**：正五边形雷达图展示5个情感维度（NEW!）
- **标签页切换**：时间线和雷达图共享同一区域，点击切换（NEW!）
- **知识库面板**：以结构化方式展示所有知识点
- **点击交互**：点击时间线节点查看详细概括信息
- **实时更新**：记忆归档、知识提取、情感分析时自动更新界面
- **多标签页**：系统信息、短期记忆、长期记忆、理解阶段、知识库、环境管理、Debug日志、控制面板

### 👁️ 智能体伪视觉系统（v6.0 NEW!）
- **环境感知**：通过数据库预设模拟智能体的视觉能力
- **智能触发**：自动识别15+个环境相关关键词（周围、看到、观察等）
- **结构化描述**：两层环境描述（整体环境 + 详细物体）
- **多感官信息**：包含视觉、听觉、嗅觉等多维度感知
- **物体管理**：支持添加、编辑、删除环境中的物体
- **优先级系统**：根据物体重要性调整显示顺序
- **可见性控制**：灵活控制物体对智能体的可见性
- **使用记录**：自动记录视觉工具的使用历史
- **详细文档**：参见 [伪视觉功能文档](VISION_FEATURE_README.md)

### 🌐 环境切换系统（v6.0 NEW!）
- **智能环境管理**：支持创建和管理多个环境
- **环境连接系统**：通过UUID记录环境间的连接关系
- **智能切换检测**：自动检测用户的环境切换意图
- **权限验证**：只允许切换到连通的环境
- **可视化管理**：图形化展示环境关系
- **GUI增强**：优化环境管理界面，支持分层添加物品
- **连接类型**：支持门、楼梯、走廊等多种连接类型
- **方向控制**：支持单向和双向连接
- **详细文档**：参见 [环境切换功能文档](ENVIRONMENT_SWITCHING.md)

## 项目结构

```
Neo_Agent/
├── .env                       # 配置文件（API密钥、角色设定、Debug模式等）
├── example.env                # 配置文件模板
├── requirements.txt           # Python依赖包
├── LICENSE                    # MIT许可证
├── README.md                  # 项目主文档（中文）
├── README_EN.md               # 项目主文档（英文）
├── CONTRIBUTING.md            # 贡献指南（中文）
├── CONTRIBUTING_EN.md         # 贡献指南（英文）
├── CHANGELOG.md               # 变更日志（中文）
├── CHANGELOG_EN.md            # 变更日志（英文）
├── ENVIRONMENT_SWITCHING.md   # 环境切换功能文档（中文）
├── ENVIRONMENT_SWITCHING_EN.md # 环境切换功能文档（英文）
├── VISION_FEATURE_README.md   # 伪视觉功能文档（中文）
├── VISION_FEATURE_README_EN.md # 伪视觉功能文档（英文）
├── VISION_DEMO.md             # 视觉功能演示（中文）
├── VISION_DEMO_EN.md          # 视觉功能演示（英文）
├── VISION_ARCHITECTURE.txt    # 视觉系统架构说明
│
├── chat_agent.py              # 聊天代理核心模块
├── long_term_memory.py        # 长效记忆管理模块
├── knowledge_base.py          # 知识库管理模块
├── base_knowledge.py          # 基础知识库模块
├── emotion_analyzer.py        # 情感关系分析模块
├── agent_vision.py            # 智能体伪视觉模块（NEW!）
├── database_gui.py            # 数据库GUI界面模块
├── database_manager.py        # 数据库管理模块
├── debug_logger.py            # Debug日志管理器
├── gui_enhanced.py            # 增强版GUI界面（推荐使用）
├── test_environment_switching.py # 环境切换功能测试
│
├── chat_agent.db              # 数据库文件（自动生成）
├── debug.log                  # Debug日志文件（自动生成）
│
└── docs/                      # 详细文档目录
    ├── README.md              # 文档中心（中文）
    ├── README_EN.md           # 文档中心（英文）
    ├── API.md                 # API参考文档（中文）
    ├── API_EN.md              # API参考文档（英文）
    ├── DEPLOYMENT.md          # 部署指南（中文）
    ├── DEPLOYMENT_EN.md       # 部署指南（英文）
    ├── DEVELOPMENT.md         # 开发者指南（中文）
    ├── DEVELOPMENT_EN.md      # 开发者指南（英文）
    ├── EXAMPLES.md            # 使用示例（中文）
    ├── EXAMPLES_EN.md         # 使用示例（英文）
    ├── TROUBLESHOOTING.md     # 故障排查指南（中文）
    └── TROUBLESHOOTING_EN.md  # 故障排查指南（英文）
```

## 安装步骤

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置API密钥

编辑`.env`文件，设置您的SiliconFlow API密钥：

```env
SILICONFLOW_API_KEY=your_api_key_here
```

### 3. 自定义角色（可选）

在`.env`文件中修改角色设定：

```env
# API配置
SILICONFLOW_API_KEY=your_api_key_here
SILICONFLOW_API_URL=https://api.siliconflow.cn/v1/chat/completions
MODEL_NAME=Qwen/Qwen2.5-7B-Instruct
TEMPERATURE=0.8
MAX_TOKENS=2000

# 角色设定
CHARACTER_NAME=小可
CHARACTER_GENDER=女
CHARACTER_ROLE=学生
CHARACTER_AGE=18
CHARACTER_PERSONALITY=活泼开朗
CHARACTER_HOBBY=文科，尤其对历史充满热情
CHARACTER_BACKGROUND=我是一名高中生，叫小可...

# 记忆设置
MEMORY_FILE=memory_data.json
LONG_MEMORY_FILE=longmemory_data.json
MAX_MEMORY_MESSAGES=50
MAX_SHORT_TERM_ROUNDS=20

# Debug模式（NEW!）
DEBUG_MODE=True
DEBUG_LOG_FILE=debug.log
```

## 使用方法

### 启动增强版GUI（推荐）

```bash
python gui_enhanced.py
```

### 命令行模式

```bash
python chat_agent.py
```

## 记忆系统详解

### 短期记忆（memory_data）

```json
{
  "messages": [
    {
      "role": "user",
      "content": "你好",
      "timestamp": "2025-11-14T20:44:10.942693"
    },
    {
      "role": "assistant",
      "content": "你好呀！我是小可...",
      "timestamp": "2025-11-14T20:44:11.855484"
    }
  ],
  "metadata": {
    "created_at": "2025-11-14T20:43:56.635027",
    "total_conversations": 3
  }
}
```

**特点**：
- 保存最近20轮对话（40条消息）
- 包含完整的对话内容和时间戳
- 超过20轮自动触发归档

### 长期记忆（longmemory_data）

```json
{
  "summaries": [
    {
      "uuid": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "created_at": "2025-11-14T10:00:00.000000",
      "ended_at": "2025-11-14T10:30:00.000000",
      "rounds": 20,
      "message_count": 40,
      "summary": "讨论了中国古代历史，重点聊了唐朝的文化和科举制度..."
    }
  ],
  "metadata": {
    "created_at": "2025-11-14T10:00:00.000000",
    "total_summaries": 1
  }
}
```

**特点**：
- 每20轮对话生成一个概括
- 使用UUID唯一标识
- 记录时间范围和对话轮数
- LLM自动生成主题概括

### 记忆归档流程

1. 用户发送消息，对话轮数+1
2. **每5轮触发知识提取**：
   - 取出最近5轮对话
   - 调用LLM提取用户信息和知识点
   - 为每条知识生成UUID和元数据
   - 保存到knowledge_base
3. **每20轮触发主题归档**：
   - 取出最早的20轮对话
   - 调用LLM生成主题概括
   - 创建长期记忆条目（含UUID和时间戳）
   - 保存到longmemory_data
   - 从短期记忆中移除已归档的对话
4. 更新GUI显示（时间线、知识库）

## 知识库系统详解

### 知识结构（knowledge_base）

```json
{
  "knowledge_items": [
    {
      "uuid": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "title": "喜欢历史",
      "content": "用户表示特别喜欢历史，尤其是中国古代史",
      "type": "偏好",
      "source": "对话记录",
      "created_at": "2025-11-14T21:00:00.000000",
      "updated_at": "2025-11-14T21:00:00.000000",
      "source_time_range": {
        "start": "2025-11-14T20:55:00.000000",
        "end": "2025-11-14T21:00:00.000000"
      },
      "tags": ["偏好", "历史"]
    }
  ],
  "metadata": {
    "created_at": "2025-11-14T20:00:00.000000",
    "total_knowledge": 1,
    "last_extraction": "2025-11-14T21:00:00.000000"
  }
}
```

### 知识类型

系统会自动将知识分类为以下类型：

- **个人信息**：用户的基本信息、身份、职业等
- **偏好**：用户的喜好、兴趣、习惯等
- **事实**：客观的事实性信息
- **经历**：用户的经历、故事、回忆等
- **观点**：用户的看法、意见、态度等
- **其他**：不属于以上类型的知识

### 知识提取原理

每5轮对话后，系统会：
1. 收集最近5轮的对话内容
2. 使用LLM分析对话，识别：
   - 用户明确提到的信息
   - 用户的偏好和兴趣
   - 用户分享的经历和故事
   - 用户表达的观点和态度
3. 将提取的知识结构化存储
4. 自动生成标签便于分类和搜索

### 记忆归档流程（更新）

## GUI功能说明

### 布局优化
- **输入框固定底部**：输入区域始终固定在界面底部，不会被其他组件挤压
- **固定高度组件**：标题栏、角色信息、记忆状态栏、输入框都使用固定高度
- **自适应聊天区**：聊天显示区域自动填充剩余空间，最大化利用界面
- **时间线紧凑显示**：主题时间线固定130px高度，不占用过多空间
- **窗口最小尺寸**：设置最小窗口尺寸为1000x700，防止布局混乱

### 主题时间线
- **节点显示**：每个节点代表一个归档的主题
- **颜色编码**：不同颜色区分不同主题
- **箭头连接**：显示主题变化的时间顺序
- **悬停效果**：鼠标悬停时改变光标
- **点击查看**：点击节点显示详细信息

### 控制面板
- **🔄 刷新所有信息**：更新所有显示区域
- **📈 更新主题时间线**：重绘时间线图
- **🗑️ 清空所有记忆**：删除短期和长期记忆
- **♻️ 重新加载代理**：重新读取配置文件

### 标签页
- **系统信息**：显示角色信息、配置参数、文件路径
- **短期记忆**：查看最近20轮的详细对话
- **长期记忆**：查看所有归档的主题概括
- **理解阶段**：查看最近一次查询的实体识别和知识检索结果（NEW!）
- **知识库**：浏览、搜索和管理知识点
  - 显示基础知识（优先级100%，🔒标记）
  - 显示普通知识（定义和相关信息）
  - 按类型分组显示
  - 关键词搜索和类型筛选
  - 查看/添加基础知识功能
  - 显示每条知识的UUID、时间、置信度
- **Debug日志**：实时查看系统运行日志（仅Debug模式）（NEW!）
  - 模块运行追踪
  - 提示词变化监控
  - API请求/响应记录
  - 错误日志追踪
  - 按类型筛选日志
  - 彩色语法高亮
- **控制面板**：操作按钮和系统设置
## 数据库管理系统（实验性）

系统提供了SQLite数据库作为JSON文件存储的替代方案：

### 特性

- **统一数据管理**：所有数据存储在单个SQLite数据库文件中
- **结构化查询**：支持复杂的SQL查询和索引
- **性能优化**：大数据量下比JSON更高效
- **可视化管理**：提供GUI界面查看和编辑数据

### 数据表结构

| 表名 | 说明 | 主要字段 |
|------|------|---------|
## 快捷键

- **Enter**：发送消息
- **Ctrl+Enter**：在输入框中换行

## 基础知识库使用指南

### 什么是基础知识？

基础知识是系统中**优先级最高、不可更改**的核心信息。它具有以下特点：

- **绝对准确**：优先级100%，置信度100%
- **强制遵循**：即使与AI的常识相悖，也必须严格遵循
- **不可覆盖**：一旦添加，不会被其他信息覆盖或修改
- **最高优先级**：在所有知识来源中优先级最高

### 使用场景

基础知识适合存储：
- 特定领域的核心定义（如："HeDaas是一个高校"）
- 项目专属的术语和概念
- 需要AI严格遵循的规则和设定
- 与常识不同但在特定场景下必须遵循的信息

### 添加基础知识

**方法1：通过GUI**
1. 打开"📚 知识库"选项卡
2. 点击"添加基础知识"按钮
3. 填写：
   - **实体名称**：如"HeDaas"
   - **事实内容**：如"HeDaas是一个高校"
   - **分类**：选择合适的分类
   - **说明**：可选的详细说明
4. 点击"保存"

**方法2：通过代码**
```python
from base_knowledge import BaseKnowledge

base_kb = BaseKnowledge()
base_kb.add_base_fact(
    entity_name="实体名",
    fact_content="事实内容",
    category="分类",
    description="说明"
)
```

### 查看基础知识

1. 在"📚 知识库"选项卡中，基础知识会显示在顶部
2. 基础知识用🔒标记，优先级100%
3. 点击"查看基础知识"按钮可查看详细信息
4. 可以看到每条基础知识的分类、描述、创建时间等

### 基础知识的工作原理

当用户提问时：
1. 系统提取问题中的实体（如"HeDaas"）
2. 优先检查基础知识库（不区分大小写）
3. 如果找到匹配的基础知识，将其嵌入提示词
4. AI会严格按照基础知识回答，而不是使用自己的常识

示例：
```
用户：你知道HeDaas吗？
系统：[检测到实体"HeDaas"] → [找到基础知识："HeDaas是一个高校"]
AI：当然知道！HeDaas是一个高校...（严格遵循基础知识）
```

## 情感关系分析系统详解（v5.0 NEW!）

### 什么是情感关系分析？

情感关系分析系统通过LLM智能分析用户与AI之间的对话，从多个维度评估情感关系状态，并根据分析结果自动调整AI的对话语气和态度，使交流更加自然和贴心。

### 核心功能

#### 1. 自动情感分析
- **触发机制**：每完成10轮对话自动执行一次分析
- **分析窗口**：基于最近10轮对话（20条消息）
- **智能去重**：避免重复分析同一轮次
- **后台执行**：不影响正常对话流程
- **实时反馈**：分析完成后在聊天窗口显示简要结果

#### 2. 多维度评估

系统从5个维度全面评估情感关系，每个维度0-100分：

| 维度 | 说明 | 影响 |
|------|------|------|
| **亲密度** | 双方关系的亲密程度 | 决定交流方式的亲昵程度 |
| **信任度** | 用户对AI的信任程度 | 影响建议的深度和坦诚度 |
| **愉悦度** | 对话中的愉悦感 | 决定语气的活泼程度 |
| **共鸣度** | 情感和话题的共鸣程度 | 影响话题深入程度 |
| **依赖度** | 用户对AI的依赖程度 | 决定支持和帮助的力度 |

#### 3. 关系类型识别

根据总体评分自动识别关系类型：

| 总分 | 关系类型 | AI语气特点 |
|------|----------|-----------|
| 0-30 | 初识/陌生人 | 礼貌友好，保持适当距离 |
| 31-50 | 普通朋友 | 友好自然，适度分享 |
| 51-70 | 好友 | 亲切热情，较多互动 |
| 71-85 | 亲密朋友 | 亲昵自在，深度交流 |
| 86-100 | 知己 | 完全信任，无话不谈 |

#### 4. 情感基调分析

识别对话的整体情感基调：
- **积极**：对话愉快、正面、乐观
- **中性**：对话平稳、客观、理性
- **消极**：对话沉重、负面、悲观

#### 5. 语气自适应

AI根据情感状态自动调整：

**关系初识时**（亲密度<40）：
- 保持礼貌友好，不过分热情
- 逐步建立信任，不急于深入
- 使用较正式的表达方式

**成为朋友时**（亲密度40-60）：
- 友好但不过分亲密
- 适度分享，注意边界
- 更自然的交流方式

**亲密朋友时**（亲密度>80）：
- 可以使用更亲昵的语气
- 像老朋友一样自在交流
- 分享更多个人想法和情感

### 数据结构（emotion_data）

```json
[
  {
    "timestamp": "2025-01-15T10:30:00.000000",
    "message_count": 20,
    "亲密度": 65,
    "信任度": 70,
    "愉悦度": 80,
    "共鸣度": 75,
    "依赖度": 55,
    "overall_score": 69,
    "relationship_type": "朋友",
    "emotional_tone": "积极",
    "key_topics": ["历史", "学习", "生活"],
    "analysis": "用户与AI已经建立了良好的朋友关系..."
  }
]
```

### 使用方法

#### 方法1：自动分析（推荐）
1. 正常与AI对话
2. 系统在第10、20、30...轮自动分析
3. 分析完成后会显示提示：
   ```
   💖 [自动情感分析] 已完成10轮对话，正在分析情感关系...
      关系类型: 朋友
      情感基调: 积极
      总体评分: 69/100
   ```
4. 切换到"💖 情感关系"标签查看详细雷达图

#### 方法2：手动分析
1. 点击"🔍 分析情感关系"按钮
2. 等待分析完成（约2-5秒）
3. 查看雷达图和详细分析报告

#### 方法3：通过代码
```python
from chat_agent import ChatAgent

agent = ChatAgent()

# 进行对话...
for i in range(15):
    response = agent.chat(f"测试消息{i}")

# 手动触发情感分析
emotion_data = agent.analyze_emotion()
print(f"关系类型: {emotion_data['relationship_type']}")
print(f"总体评分: {emotion_data['overall_score']}/100")

# 查看历史
history = agent.get_emotion_history()
print(f"共有 {len(history)} 次分析记录")
```

### 可视化展示

#### 雷达图

在GUI的"数据可视化"区域，切换到"💖 情感关系"标签：

- **正五边形雷达图**：5个顶点代表5个情感维度
- **填充区域**：蓝色半透明填充显示情感强度
- **数据点**：每个维度的具体分数
- **中心信息**：显示关系类型、总评分、情感基调
- **详细报告**：右侧显示完整的文字分析

#### 标签页切换

- **📈 主题时间线**：查看对话主题变化
- **💖 情感关系**：查看情感状态和雷达图
- 两个标签共享同一可视化区域，点击切换

### 工作流程

```
第1-9轮对话  → 正常对话
第10轮对话   → 触发自动情感分析
              ↓
         分析最近10轮对话
              ↓
         生成5维度评分
              ↓
         保存到chat_agent.db
              ↓
         自动刷新GUI雷达图
              ↓
第11轮对话   → AI根据情感状态调整语气
              ↓
         （使用情感语气提示）
              ↓
第12-19轮   → 继续使用调整后的语气
第20轮      → 再次触发情感分析，更新状态
```

### Debug支持

启用DEBUG_MODE后，可以查看详细的情感分析过程：

```
[2025-01-15 10:30:00] [info] ChatAgent
检查自动情感分析触发条件
| current_rounds: 10
| is_trigger_round: True

[2025-01-15 10:30:02] [info] ChatAgent
自动情感分析完成
| relationship_type: 朋友
| overall_score: 69
| analysis_time: 2.15s

[2025-01-15 10:30:02] [info] EmotionAnalyzer
情感语气提示生成完成
| prompt_length: 1250
```

详细的debug文档请参考：
- `AUTO_EMOTION_DEBUG.md` - 完整debug文档
- `AUTO_EMOTION_QUICKREF.md` - 快速参考指南

### 测试脚本

```bash
# 普通测试（无debug）
python test_auto_emotion.py

# Debug模式测试
python test_auto_emotion_debug.py

# 基础情感分析测试
python test_emotion.py
python test_emotion_debug.py
```

### 最佳实践

1. **开发阶段**
   - 启用DEBUG_MODE查看详细过程
   - 使用测试脚本验证功能
   - 观察AI语气变化是否合理

2. **使用阶段**
   - 关闭DEBUG_MODE提高性能
   - 定期查看情感数据了解关系发展
   - 根据需要调整分析频率（默认每10轮）

3. **定制调整**
   - 修改触发频率：编辑`chat_agent.py`中的`% 10`
   - 调整分析窗口：修改`analyze_emotion()`的消息数量
   - 自定义语气提示：编辑`generate_tone_prompt()`方法

### 性能影响

- **分析耗时**：1-5秒（取决于API响应速度）
- **触发频率**：每10轮1次
- **内存占用**：约1-2KB per分析记录
- **Debug开销**：约5-10%性能下降（可关闭）

### 隐私说明

- 情感数据保存在本地`chat_agent.db`的`emotion_data`键下
- 不会上传到服务器（仅API调用时传输对话内容）
- 可随时删除情感数据文件重置记录
- 建议妥善保管包含对话内容的文件

---

## 快捷键

### 启用Debug模式

在`.env`文件中设置：
```env
DEBUG_MODE=True
DEBUG_LOG_FILE=debug.log
```

### Debug日志界面

启用Debug模式后，GUI中会出现"🔧 Debug日志"选项卡：

**功能：**
- **实时日志流**：自动显示新产生的日志
- **类型筛选**：可筛选module/prompt/request/response/error/info
- **自动刷新**：可开启/关闭自动刷新
- **彩色显示**：不同类型日志用不同颜色高亮
- **统计信息**：显示各类型日志的数量

**日志类型：**
- 🟢 **module**（模块）：模块运行状态
- 🟠 **prompt**（提示词）：发送给LLM的提示词
- 🔵 **request**（请求）：API请求详情
- 🔷 **response**（响应）：API响应详情
- 🔴 **error**（错误）：错误和异常信息
- 🟡 **info**（信息）：一般性信息

### 查看完整日志

GUI中的日志会截断长内容，完整日志保存在`debug.log`文件中：
```
打开 debug.log 查看：
- 完整的提示词内容
- 完整的API请求/响应
- 详细的错误堆栈
```

### 使用Debug日志排查问题

**问题1：基础知识没有生效**
1. 查看"实体提取"日志，确认实体是否被正确识别
2. 查看"查找实体"日志，确认是否找到基础知识
3. 查看"知识库上下文"提示词，确认基础知识是否被包含

**问题2：API调用失败**
1. 查看request日志，检查请求参数
2. 查看response日志，检查状态码和错误信息
3. 查看error日志，查看详细错误原因

**问题3：AI回复不符合预期**
1. 查看所有prompt日志，检查发送给AI的完整提示词
2. 确认知识库上下文是否正确
3. 确认角色设定是否合适

### 性能监控

Debug日志会记录每次API调用的耗时：
```
[RESPONSE] SiliconFlowLLM | 状态:200 | 耗时:0.98s
```

可以用来分析：
- API响应速度
- 系统性能瓶颈
- 优化机会

## 注意事项

1. **API密钥**：必须配置有效的SiliconFlow API密钥
2. **网络连接**：需要稳定的网络连接调用API
3. **记忆文件**：首次运行会自动创建记忆文件
4. **归档触发**：只有在第21轮对话时才会触发归档
5. **概括质量**：概括质量取决于LLM模型的能力
6. **基础知识谨慎添加**：基础知识优先级最高，会覆盖AI常识，请谨慎添加
7. **Debug模式性能**：开启Debug模式会略微降低性能，生产环境建议关闭
8. **日志文件大小**：长时间运行会产生大量日志，建议定期清理debug.log

## 技术架构

### 总体架构

系统采用分层架构设计，从上至下分为表现层、业务逻辑层、数据持久层和外部服务层。

```
┌───────────────────────────────────────────────────────────────────┐
│                    表现层 (Presentation Layer)                     │
│  ┌────────────────────────────────────────────────────────────┐   │
│  │              GUI Enhanced (Tkinter)+database_gui           │   │
│  │  • 聊天界面 • 可视化面板 • 标签页管理 • 实时更新              │   │
│  │  • 主题时间线 • 情感雷达图 • Debug监控 • 数据库面板           │   │
│  └────────────────────────────────────────────────────────────┘   │
└───────────────────────────────┬───────────────────────────────────┘
                                │ UI Events / Data Binding
┌───────────────────────────────▼───────────────────────────────────┐
│                   业务逻辑层 (Business Layer)                      │
│  ┌─────────────────────────────────────────────────────────────┐  │
│  │                    ChatAgent (核心控制器)                    │  │
│  │  • 对话流程控制 • 记忆管理调度 • 知识检索 • 情感分析触发        │  │
│  └─────────────────────────────────────────────────────────────┘  │
│                                │                                  │
│     ┌──────────────────────────┼──────────────────────────┐       │
│     ▼                          ▼                          ▼       │
│   ┌─────────┐              ┌─────────────┐       ┌──────────────┐ │
│   │ Memory  │              │ Knowledge   │       │  Emotion     │ │
│   │ Manager │              │ Manager     │       │  Analyzer    │ │
│   └─────────┘              └─────────────┘       └──────────────┘ │
│     │                             │                   │           │
│     └─────┬──────────┬────────────┼────────────┬──────┘           │
│           ▼          ▼            ▼            ▼                  │
│         ┌──────┐  ┌──────┐  ┌──────────┐  ┌─────────┐             │
│         │Short │  │Long  │  │Knowledge │  │  Base   │             │
│         │Term  │  │Term  │  │  Base    │  │Knowledge│             │
│         └──────┘  └──────┘  └──────────┘  └─────────┘             │
└───────────────────────────────────────────────────────────────────┘
                                │
┌───────────────────────────────▼───────────────────────────────────┐
│                  数据持久层 (Persistence Layer)                    │
│   ┌────────────────────────────────────────────────────────────┐  │
│   │                SQList  (Database Manager)                  │  │
│   │              • 记忆数据 • 知识数据 • 情感数据                │  │
│   └────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────┘
                                │
┌───────────────────────────────▼───────────────────────────────────┐
│                  外部服务层 (External Services)                    │
│  ┌────────────────────────────────────────────────────────────┐   │
│  │        LLM API (SiliconFlow / DeepSeek / Qwen)             │   │
│  │  • 对话生成 • 记忆概括 • 知识提取 • 情感分析                  │   │
│  └────────────────────────────────────────────────────────────┘   │
└───────────────────────────────────────────────────────────────────┘
```

### 核心模块详解

#### 1. 表现层 (GUI Enhanced)

**职责**：用户交互、数据展示、事件处理

**关键组件**：
- **ChatInterface**: 对话显示和输入
- **TopicTimelineCanvas**: 主题时间线可视化（Canvas绘图）
- **EmotionRadarCanvas**: 情感雷达图可视化（正五边形）
- **DebugPanel**: 实时日志监控和筛选
- **ControlPanel**: 系统操作和配置

**技术特点**：
- 响应式布局，自适应窗口大小
- 异步更新机制，避免UI阻塞
- 标签页懒加载，优化性能
- Canvas图形渲染，支持交互

#### 2. 业务逻辑层 (ChatAgent)

**核心控制器** - `chat_agent.py`

负责整个对话流程的编排和控制：

```python
用户输入
   ↓
【1. 消息预处理】
   ↓
【2. 实体识别】→ 提取关键实体
   ↓
【3. 知识检索】
   ├─ 基础知识库 (优先级100%)
   ├─ 普通知识库 (优先级60-90%)
   └─ 长期记忆 (背景信息)
   ↓
【4. 情感状态检查】
   ├─ 是否第10轮？→ 触发自动分析
   └─ 生成语气提示
   ↓
【5. 构建提示词】
   ├─ 系统提示 (角色设定)
   ├─ 情感语气提示
   ├─ 知识上下文 (按优先级排序)
   └─ 对话历史
   ↓
【6. LLM调用】
   ↓
【7. 响应后处理】
   ├─ 保存到短期记忆
   ├─ 每5轮：知识提取
   ├─ 每10轮：情感分析
   └─ 每20轮：记忆归档
   ↓
返回响应 + 更新GUI
```

#### 3. 记忆管理系统

**三层记忆架构** - `long_term_memory.py`

```
┌────────────────────────────────────────────────────────┐
│                   短期记忆 (Short Term)                 │
│  • 容量：最近20轮对话（40条消息）                        │
│  • 格式：完整对话内容 + 时间戳                           │
│  • 用途：提供最近的对话上下文                            │
│  • 触发：每次对话自动保存                                │
│  • 键：memory_data                                     │
└────────────────────────────────────────────────────────┘
                        ↓ 每20轮归档
┌────────────────────────────────────────────────────────┐
│                   长期记忆 (Long Term)                  │
│  • 容量：无限制（按主题概括）                            │
│  • 格式：主题概括 + UUID + 时间范围                      │
│  • 用途：提供历史对话的主题背景                          │
│  • 触发：每20轮自动生成概括                              │
│  • 键：longmemory_data                                 │
│  • 特点：LLM自动生成主题摘要                             │
└────────────────────────────────────────────────────────┘
                        ↓ 提取结构化信息
┌────────────────────────────────────────────────────────┐
│                   知识库 (Knowledge Base)               │
│  • 容量：无限制（结构化存储）                            │
│  • 格式：标题+内容+类型+标签+UUID                        │
│  • 用途：提供用户相关的结构化知识                         │
│  • 触发：每5轮自动提取                                   │
│  • 键：knowledge_base                                   │
│  • 分类：个人信息/偏好/事实/经历/观点                     │
└────────────────────────────────────────────────────────┘
                        ↑ 核心知识
┌────────────────────────────────────────────────────────┐
│               基础知识库 (Base Knowledge)               │
│  • 优先级：100% (最高)                                  │
│  • 特点：不可覆盖、强制遵循                              │
│  • 格式：实体+事实+分类+描述                             │
│  • 用途：存储核心定义和规则                              │
│  • 键：base_knowledge                                  │
│  • 匹配：不区分大小写                                    │
└────────────────────────────────────────────────────────┘
```

#### 4. 知识管理系统

**知识库管理** - `knowledge_base.py`

```
【知识提取流程】
最近5轮对话
   ↓
LLM分析提取
   ├─ 个人信息 (姓名、职业、年龄等)
   ├─ 偏好喜好 (兴趣、爱好、习惯)
   ├─ 客观事实 (事件、状态、关系)
   ├─ 个人经历 (故事、回忆、经验)
   └─ 观点态度 (看法、意见、立场)
   ↓
结构化存储
   ├─ UUID (唯一标识)
   ├─ 标题 + 内容
   ├─ 类型 + 标签
   ├─ 来源时间范围
   ├─ 置信度 (0.7-1.0)
   └─ 创建/更新时间
   ↓
【知识检索流程】
用户查询
   ↓
实体识别
   ↓
知识匹配
   ├─ 基础知识 (优先级100%, 置信度100%)
   ├─ 定义类知识 (优先级90%, is_definition=True)
   └─ 相关信息 (优先级60-80%)
   ↓
按优先级排序
   ↓
构建知识上下文
   ↓
注入提示词
```

**基础知识库** - `base_knowledge.py`

特殊的知识存储，用于绝对准确的核心信息：
- **优先级**: 100% (高于所有其他知识源)
- **置信度**: 100% (绝对可信)
- **不可变**: 一旦添加不会被覆盖
- **强制遵循**: AI必须严格遵循，即使与常识相悖
- **用例**: "HeDaas是一个高校"（特定定义）

#### 5. 情感分析系统 (v5.0)

**情感分析器** - `emotion_analyzer.py`

```
【自动分析流程】
每10轮对话触发
   ↓
提取最近10轮对话 (20条消息)
   ↓
LLM多维度分析
   ├─ 亲密度 (关系亲密程度)
   ├─ 信任度 (信任和依赖)
   ├─ 愉悦度 (对话愉快度)
   ├─ 共鸣度 (情感共鸣)
   └─ 依赖度 (依赖程度)
   ↓
综合评估
   ├─ 总体评分 (0-100)
   ├─ 关系类型 (初识/朋友/知己等)
   ├─ 情感基调 (积极/中性/消极)
   ├─ 主要话题
   └─ 详细分析
   ↓
保存历史记录 → chat_agent.db
   ↓
【语气调整流程】
读取最新情感数据
   ↓
生成语气提示
   ├─ 关系类型对应的交流方式
   ├─ 各维度的具体建议
   ├─ 情感基调的态度要求
   └─ 综合评分的整体指导
   ↓
注入系统消息
   ↓
LLM根据提示调整语气
   ↓
输出符合情感状态的回复
```

**情感雷达图** - `EmotionRadarCanvas`

正五边形可视化：
- 5个顶点代表5个维度
- 蓝色填充显示情感强度
- 中心显示关系类型和总分
- 支持动态缩放和更新

#### 6. Debug系统 (v4.0)

**Debug日志管理** - `debug_logger.py`

```
【日志记录系统】
6种日志类型
   ├─ module: 模块运行追踪
   ├─ prompt: 提示词内容记录
   ├─ request: API请求详情
   ├─ response: API响应和耗时
   ├─ error: 错误和异常
   └─ info: 一般信息
   ↓
双重输出
   ├─ 内存列表 (GUI实时显示)
   └─ 文件持久化 (debug.log)
   ↓
GUI可视化
   ├─ 实时日志流
   ├─ 类型筛选
   ├─ 彩色高亮
   ├─ 自动滚动
   └─ 统计信息
```

### 数据流图

```
┌──────────┐
│   用户    │
└────┬─────┘
     │ 输入消息
     ▼
┌─────────────────────────────────────────┐
│              ChatAgent                  │
│  1. 添加到短期记忆                       │
│  2. 检查轮数触发器                       │
│     ├─ 每5轮  → 知识提取                 │
│     ├─ 每10轮 → 情感分析                 │
│     └─ 每20轮 → 记忆归档                 │
│  3. 实体识别 + 知识检索                  │
│  4. 构建提示词（含情感语气）              │
│  5. 调用LLM                             │
│  6. 后处理 + 保存                        │
└─────────┬───────────────────────────────┘
          ▼
    ┌────────────┐
    │   GUI更新  │
    │  - 聊天显示 │
    │  - 雷达图   │
    │  - 时间线   │
    │  - 统计信息 │
    └────────────┘
```

### 技术栈

| 层级 | 技术              | 用途            |
|------|-----------------|---------------|
| **前端UI** | Tkinter         | GUI框架         |
|  | Canvas          | 图形绘制（时间线、雷达图） |
|  | ttk             | 现代化控件         |
| **后端逻辑** | Python 3.12+    | 核心语言          |
|  | LangChain       | LLM应用框架       |
|  | Threading       | 异步处理          |
| **数据存储** | SQList          | 结构化数据库        |
|  | UUID            | 唯一标识符         |
| **外部服务** | SiliconFlow API | LLM接口         |
|  | DeepSeek / Qwen | 模型选择          |
| **开发工具** | python-dotenv   | 环境配置          |
|  | Debug Logger    | 调试追踪          |

### 性能优化

#### 1. 异步处理
- GUI操作在主线程
- LLM调用在后台线程
- 避免界面卡顿

#### 2. 智能缓存
- 短期记忆缓存最近20轮
- 知识库按UUID索引
- 情感数据避免重复分析

#### 3. 分页加载
- Debug日志限制500条显示
- 长期记忆按需加载
- 知识库分类展示

#### 4. 增量更新
- 只更新变化的UI组件
- Canvas局部重绘
- 选择性刷新标签页

### 扩展性设计

#### 1. 模块化架构
每个功能模块独立，易于维护和扩展

#### 2. 插件化接口
- LLM接口可切换不同服务商
- 记忆管理可扩展新类型
- 可视化组件可自定义

#### 3. 配置驱动
- .env文件统一配置
- 运行时参数可调整
- 支持热更新部分配置

#### 4. 数据版本化
- 版本控制
- 向后兼容旧数据
- 自动数据迁移

### 安全性考虑

1. **API密钥保护**: 使用.env文件，不提交到版本控制
2. **数据本地化**: 所有数据本地存储，不上传云端
3. **输入验证**: 防止注入攻击
4. **错误隔离**: 异常不影响主流程
5. **日志脱敏**: Debug日志中隐藏敏感信息

## 开发信息

- **版本**：v5.0
- **开发时间**：2025年11月
- **技术栈**：Python 3.12+, Tkinter, LangChain, SiliconFlow API
- **许可证**：MIT

## 常见问题

### 记忆系统相关

#### Q: 为什么没有生成长期记忆？
**A**: 长期记忆只在对话超过20轮时才会自动生成。请确保已经进行了至少21轮对话。系统会在第20轮对话后自动将前20轮归档为一个主题概括。

#### Q: 如何修改归档轮数？
**A**: 在`.env`文件中修改`MAX_SHORT_TERM_ROUNDS`参数（默认20）。例如：
```env
MAX_SHORT_TERM_ROUNDS=30  # 改为30轮归档一次
```

#### Q: 短期记忆会丢失吗？
**A**: 不会。短期记忆保存在`memory_data`中，即使重启程序也会自动加载。超过20轮的对话会被归档到长期记忆，不会丢失。

### 知识库相关

#### Q: 为什么没有提取到知识？
**A**: 知识提取每5轮对话触发一次。可能的原因：
1. 对话轮数不足5轮
2. 对话中没有明确的用户信息或知识点
3. LLM未能识别出可提取的知识

**建议**：在对话中明确分享个人信息、偏好或经历，例如"我喜欢历史"、"我是学生"等。

#### Q: 如何修改知识提取频率？
**A**: 在`chat_agent.py`中修改触发条件：
```python
# 原来：每5轮
if current_rounds > 0 and current_rounds % 5 == 0:

# 修改为：每3轮
if current_rounds > 0 and current_rounds % 3 == 0:
```

#### Q: 知识提取的内容不准确？
**A**: 知识提取质量取决于LLM模型的理解能力。可以尝试：
1. 在`.env`中使用更强大的模型（如DeepSeek-V3）
2. 在对话中更明确地表达信息
3. 提供更多上下文和细节
4. 启用DEBUG_MODE查看提取过程

#### Q: 如何手动删除某条知识？
**A**: 
- **方法1**：直接编辑`knowledge_base`键，找到对应UUID删除
- **方法2**：删除整个文件重新开始（会丢失所有知识）
- **注意**：GUI暂不支持删除功能，计划在未来版本添加

### 基础知识库相关

#### Q: 基础知识没有生效？
**A**: 排查步骤：
1. 启用DEBUG_MODE，查看debug日志
2. 检查实体是否被正确识别（查看"实体提取"日志）
3. 确认基础知识已添加到`base_knowledge`
4. 查看知识上下文是否包含基础知识
5. 基础知识查询不区分大小写（HeDaas/hedaas/HEDAAS都能匹配）

#### Q: 如何修改已有的基础知识？
**A**: 基础知识设计为不可修改。如需修改：
1. **推荐**：通过GUI删除后重新添加
2. **直接编辑**：修改`base_knowledge`键
3. **注意**：修改基础知识会影响AI的回答行为，请谨慎操作

#### Q: 基础知识和普通知识有什么区别？
**A**: 
| 特性 | 基础知识 | 普通知识 |
|------|---------|---------|
| 优先级 | 100% (最高) | 60-90% |
| 置信度 | 100% | 70-100% |
| 可修改 | 否 | 是 |
| 可覆盖 | 否 | 是 |
| 用途 | 核心定义、规则 | 一般信息 |

### 情感分析相关 ⭐NEW

#### Q: 情感分析什么时候触发？
**A**: 
- **自动触发**：每10轮对话自动分析一次（第10、20、30轮...）
- **手动触发**：点击"🔍 分析情感关系"按钮
- **最少轮数**：至少需要1轮对话（2条消息）才能分析

#### Q: 为什么第10轮没有触发情感分析？
**A**: 可能的原因：
1. 实际对话轮数未达到10轮（检查聊天记录计数）
2. 已经对第10轮进行过分析（系统避免重复）
3. 启用DEBUG_MODE查看"检查自动情感分析触发条件"日志

#### Q: 情感分析的结果准确吗？
**A**: 准确性取决于：
1. **对话质量**：对话内容越丰富，分析越准确
2. **对话轮数**：基于10轮对话，样本越多越好
3. **LLM模型**：更强的模型理解能力更好
4. **表达清晰度**：清晰的情感表达有助于分析

#### Q: AI的语气真的会根据情感调整吗？
**A**: 会的！系统会：
1. 根据情感分析生成详细的语气提示
2. 将提示注入到系统消息中
3. LLM根据提示调整回复的语气和态度
4. 启用DEBUG_MODE可以看到完整的语气提示内容

#### Q: 如何修改情感分析频率？
**A**: 在`chat_agent.py`中修改：
```python
# 原来：每10轮
if current_rounds > 0 and current_rounds % 10 == 0:

# 改为每5轮
if current_rounds > 0 and current_rounds % 5 == 0:

# 改为每20轮
if current_rounds > 0 and current_rounds % 20 == 0:
```

#### Q: 情感雷达图不显示？
**A**: 排查步骤：
1. 确认已进行过至少一次情感分析
2. 切换到"💖 情感关系"标签页
3. 检查`emotion_data`键是否存在
4. 点击"🔍 分析情感关系"手动触发
5. 查看GUI右下角是否有错误提示

#### Q: 如何重置情感数据？
**A**: 
- **方法1**：删除`emotion_data`键
- **方法2**：手动编辑文件，清空数组`[]`
- **注意**：重置后会丢失所有情感分析历史

#### Q: 情感分析会消耗API额度吗？
**A**: 会的。每次分析需要调用一次LLM API（约1000 tokens）。建议：
1. 使用默认的10轮频率（不要太频繁）
2. 关注API使用量和余额
3. 必要时手动触发而非自动分析

### 可视化相关

#### Q: 时间线不显示？
**A**: 
1. 确保窗口大小足够大（最小1000x700）
2. 至少需要1个长期记忆（20轮对话后生成）
3. 点击"📈 更新主题时间线"按钮刷新
4. 检查是否在"📈 主题时间线"标签页

#### Q: 雷达图和时间线切换在哪里？
**A**: 在GUI上方的"数据可视化"区域，有两个标签页：
- **📈 主题时间线**：显示对话主题演变
- **💖 情感关系**：显示情感雷达图
点击标签即可切换。

#### Q: 如何导出可视化图表？
**A**: 目前不支持直接导出。可以：
1. 使用截图工具保存
2. 查看对应的数据库文件获取原始数据
3. 计划在未来版本添加导出功能

### Debug相关

#### Q: Debug日志太多怎么办？
**A**: 
1. 在GUI中使用类型筛选功能（只看error/info等）
2. 关闭"自动刷新"开关，按需手动刷新
3. 点击"清空日志"按钮清理
4. 生产环境设置`DEBUG_MODE=False`

#### Q: 如何查看特定模块的日志？
**A**: 
1. 在Debug日志中使用浏览器的查找功能（Ctrl+F）
2. 搜索模块名称：EmotionAnalyzer、ChatAgent、KnowledgeBase等
3. 或使用类型筛选，只看prompt/request/response等

#### Q: Debug日志保存在哪里？
**A**: 
- **文件位置**：项目根目录的`debug.log`
- **格式**：纯文本，包含时间戳
- **大小控制**：建议定期清理（文件会持续增长）
- **隐私**：包含对话内容，注意保护

### API和性能相关

#### Q: API调用失败？
**A**: 检查：
1. API密钥是否正确（`.env`文件中的`SILICONFLOW_API_KEY`）
2. 网络连接是否正常
3. API额度是否充足
4. API服务是否可用（访问SiliconFlow官网确认）
5. 查看Debug日志中的error类型日志

#### Q: 响应速度慢？
**A**: 可能原因和解决方案：
1. **网络问题**：检查网络连接
2. **模型选择**：较大模型响应较慢，可换用较小模型
3. **对话历史过长**：系统会自动归档，无需手动处理
4. **API限流**：等待或升级API套餐
5. **本地性能**：检查CPU和内存使用情况

#### Q: 如何切换不同的LLM模型？
**A**: 在`.env`文件中修改：
```env
# DeepSeek V3（推荐，性能好）
MODEL_NAME=deepseek-ai/DeepSeek-V3

# Qwen 2.5（速度快）
MODEL_NAME=Qwen/Qwen2.5-7B-Instruct

# 其他支持的模型
MODEL_NAME=your-model-name
```

### 数据管理相关

#### Q: 如何备份数据？
**A**: 备份以下db文件：
```
chat_agent.db #数据库
```
定期复制这些文件到安全位置。

#### Q: 如何迁移到新电脑？
**A**: 
1. 复制上述db文件
2. 复制`.env`配置文件
3. 在新电脑上安装依赖：`pip install -r requirements.txt`
4. 将db文件放到新项目目录
5. 运行程序，数据自动加载

#### Q: 数据文件损坏怎么办？
**A**: 
1. **有备份**：使用备份文件替换
2. **无备份**：删除损坏文件，系统会重新创建空文件
3. **部分损坏**：尝试手动编辑db修复
4. **预防**：定期备份，不要在运行时手动编辑文件
2. 关闭"自动刷新"开关
3. 点击"清空日志"按钮清理
4. 生产环境设置DEBUG_MODE=False

## 版本历史

### v5.0 (2025-01-15) - 情感关系分析版 ⭐NEW
- ✅ 新增情感关系分析系统
- ✅ 自动情感分析（每10轮触发）
- ✅ 5维度情感评估（亲密度、信任度、愉悦度、共鸣度、依赖度）
- ✅ 关系类型识别和情感基调分析
- ✅ 情感雷达图可视化（正五边形）
- ✅ AI语气自适应（根据情感状态调整）
- ✅ 情感数据持久化（emotion_data）
- ✅ 时间线与雷达图标签页切换
- ✅ GUI自动刷新情感显示
- ✅ 完整的debug日志支持
- 🎨 优化可视化区域布局



### v4.0 (2025-11-15) - Debug与基础知识库版
- ✨ 新增基础知识库系统（优先级100%，不可更改）
- ✨ 新增Debug日志追踪系统
- ✨ GUI新增Debug日志选项卡（实时监控）
- ✨ 基础知识管理功能（查看/添加）
- 🔧 修复基础知识不被检索的问题
- 🔧 实现不区分大小写的实体匹配
- 🎨 优化知识库显示，区分基础知识和普通知识
- 🎨 知识上下文构建优化，明确标记优先级
- 📝 添加完整的debug日志追踪


### v3.0 (2025-11-14) - 知识库版
- ✨ 新增知识库系统
- ✨ 自动知识提取功能（每5轮）
- ✨ 知识分类和标签系统
- ✨ 知识库搜索和筛选功能
- ✨ 知识库可视化面板
- 🎨 优化GUI布局，输入框固定底部
- 🎨 添加知识提取提示消息


### v2.0 (2025-11-14) - 增强版
- ✨ 新增分层记忆系统（短期+长期）
- ✨ 新增主题时间线可视化
- ✨ 新增自动概括生成功能
- ✨ 新增UUID标识系统
- 🎨 优化GUI界面布局
- 📝 完善中文注释

### v1.0
- 基础对话功能
- 角色扮演
- 简单记忆系统
- 基础GUI界面

---

## 📖 更多文档

想要深入了解 Neo_Agent？查看我们的详细文档：

### 新手入门
- 📘 **[快速开始](#安装步骤)** - 5分钟快速上手指南
- 📙 **[使用示例](docs/EXAMPLES.md)** - 丰富的实际应用场景和代码示例
- 📗 **[故障排查](docs/TROUBLESHOOTING.md)** - 遇到问题？这里有解决方案

### 开发者文档
- 📕 **[API参考](docs/API.md)** - 完整的API接口文档
- 📔 **[开发指南](docs/DEVELOPMENT.md)** - 深入了解项目架构和开发流程
- 📓 **[贡献指南](CONTRIBUTING.md)** - 如何为项目做出贡献

### 部署和运维
- 📒 **[部署指南](docs/DEPLOYMENT.md)** - 本地、生产、Docker、云端部署
- 📃 **[变更日志](CHANGELOG.md)** - 版本历史和更新记录

## 🤝 参与贡献

我们欢迎各种形式的贡献！无论是：

- 🐛 报告Bug
- 💡 提出新功能建议
- 📝 改进文档
- 🔧 提交代码修复
- ⭐ Star本项目

请阅读我们的 [贡献指南](CONTRIBUTING.md) 了解详情。

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🙏 致谢

感谢所有为本项目做出贡献的开发者和用户！

---

<div align="center">

**如果这个项目对你有帮助，请给个 ⭐ Star 支持一下！**

Made with ❤️ by [HeDaas-Code](https://github.com/HeDaas-Code)

</div>

